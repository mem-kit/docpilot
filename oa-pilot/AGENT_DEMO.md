# Agent功能演示

## 🎬 快速演示

### 步骤1: 启用Agent模式

1. 打开应用后，点击右侧聊天面板的 **"🔧 Load MCP"** 按钮
2. 看到 "✅ Agent mode enabled with Function Calling support!" 提示
3. 状态栏显示 **"🤖 Agent Mode ON"**

### 步骤2: 测试基本功能

**测试Word文档操作:**

```
输入: "帮我在文档中插入一个段落"
```

Agent会自动:
1. 理解您的意图
2. 调用 `updateParagraph` 函数
3. 在文档中插入新段落
4. 回复: "✅ 已成功在文档中插入新段落！"

**测试格式化文本:**

```
输入: "添加一些格式化文本"
```

Agent会:
1. 调用 `insertFormattedText` 函数
2. 插入包含粗体、斜体、下划线的文本
3. 确认操作完成

**测试Excel操作:**

```
输入: "更新表格"
```

前提: 需要先在文件列表中选择一个Excel文件

### 步骤3: 高级用法

**链式操作:**
```
输入: "先插入一个段落，然后添加格式化文本"
```

Agent会按顺序执行两个操作。

**条件操作:**
```
输入: "如果是Word文档就插入段落，如果是Excel就更新表格"
```

Agent会根据当前文档类型选择合适的操作。

## 🎯 实际使用场景

### 场景1: 快速文档编辑

**任务**: 需要在多个文档中添加相同的声明文本

**传统方式**: 
- 打开每个文档
- 手动输入或复制粘贴
- 设置格式

**使用Agent**:
```
"在文档开头插入版权声明段落"
```

### 场景2: 批量数据更新

**任务**: 更新Excel表格中的数据

**使用Agent**:
```
"更新表格的A1单元格"
```

### 场景3: 演示文稿修改

**任务**: 修改PPT第一页的标题

**使用Agent**:
```
"更新PPT的标题幻灯片"
```

## 📊 功能对比

| 操作方式 | 传统手动 | 使用Agent |
|---------|---------|----------|
| 操作步骤 | 5-10步 | 1条指令 |
| 学习成本 | 需熟悉软件 | 自然语言即可 |
| 批量处理 | 重复劳动 | 自动执行 |
| 错误率 | 人为失误 | 程序化减少错误 |

## 🔍 实时反馈

Agent执行过程中会显示:

1. **工具调用提示**:
   ```
   🔧 正在执行: updateParagraph
   ```

2. **执行结果**:
   ```
   结果: ✅ 成功
   ```

3. **友好回复**:
   ```
   ✅ 已成功在文档中插入新段落！
   ```

## 💡 最佳实践

### ✅ 推荐做法

- 使用清晰、具体的指令
- 一次执行一个主要任务
- 先选择正确类型的文档
- 查看执行反馈确认结果

### ❌ 避免事项

- 模糊的指令："改一下文档"
- 没有选择文档就发指令
- 同时请求多个复杂操作
- 忽略错误提示继续操作

## 🎓 提示词技巧

### 有效的提示词模式

**明确动作**:
- ✅ "插入一个段落"
- ✅ "添加格式化文本"
- ❌ "弄个东西"

**指定目标**:
- ✅ "在文档中插入"
- ✅ "更新Excel表格"
- ❌ "改改这个"

**礼貌表达**:
- ✅ "帮我插入一个段落"
- ✅ "请添加格式化文本"
- ✅ "插入一个段落"（直接命令也可）

## 🎨 UI元素说明

### 状态指示器

- **🤖 Agent Mode ON**: Agent模式已启用，可以执行文档操作
- **⚠️ Editor not ready**: 编辑器未就绪，需等待文档加载
- **✓ 已就绪**: 文档编辑器就绪，可以开始操作

### 消息类型

- **👤 用户消息**: 您的输入
- **🤖 助手回复**: Agent的文字回复
- **🔧 工具执行**: 工具调用的实时反馈（橙色背景）
- **⚙️ 系统消息**: 配置和状态信息

## 🚀 性能优化

- Agent响应时间: ~1-3秒
- 工具执行时间: ~100-500ms
- 支持并发处理多个工具调用

## 🔐 安全说明

- 所有操作在浏览器本地执行
- LLM仅用于意图理解和工具选择
- 不会自动执行破坏性操作
- 每次工具调用都有明确反馈

## 📈 监控和日志

浏览器控制台会显示:
```javascript
🔧 LLM requested tool: updateParagraph {}
🔧 Executing tool: updateParagraph {}
```

用于调试和监控Agent行为。

## 🎁 示例对话完整流程

```
用户: "帮我在文档中插入一个段落"

🤖 Agent: [分析意图] → 需要调用updateParagraph工具

系统显示: 
🔧 正在执行: updateParagraph
结果: ✅ 成功

🤖 Agent: "✅ 已成功在文档中插入新段落！内容已添加到您的文档中。"

文档中: [新段落已出现: "这是新插入的段落 from React"]
```

---

**开始体验智能文档操作吧！** 🎉
